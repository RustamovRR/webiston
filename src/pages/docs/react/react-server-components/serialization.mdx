## Seriyalash

React elementlarini seriyalashda ish biroz qiyinlashadi. React elementlarini seriyalash dasturiy ta'minotingizni dastlabki yuklanishda to'g'ri va samarali render qilishini ta'minlashning asosiy jihati hisoblanadi, chunki serverdan olingan bir xil renderlangan chiquvchi natija klient bilan mos kelishi kerak, shunda React to'g'ri muvofiqlashtirishi va farqlarni aniqlashi mumkin. Dasturiy ta'minotingiz serverda render qilinayotganda, yaratilgan React elementlari HTML satrlariga aylantirilishi kerak, buning yordamida ularni brauzerga yuborish mumkin. React elementlarini satrlarga, ya'ni string’ga, aylantirish jarayoni **seriyalash(serialization)** deb ataladi.


### Odatiy React Ilovasi namunasida
Odatiy React ilovasida, React elementlari xotirada obyektlar hisoblanadi. Ular `React.createElement` chaqirilishi yoki JSX sintaksisi yordamida yaratiladi. Ushbu elementlar komponentning mo'ljallangan renderlanishini ifodalaydi, lekin ular hali real DOM elementlari emas. Ular DOM qanday ko'rinishda bo'lishi kerakligi haqida ko'rsatmalardir:
``` jsx copy
const element = <h1>Hello, world</h1>;
```

Serverda `ReactDOMServer.renderToString` kabi funksiya yordamida render qilinayotganda, ushbu React elementlari HTML satrlariga seriyalashtiriladi. Bu seriyalash jarayoni React elementlar daraxtini o'z ichiga oladi, har bir element uchun mos HTML yaratadi va barchasini bitta HTML satriga birlashtiradi:
``` jsx copy
const htmlString = ReactDOMServer.renderToString(element);
// htmlString <h1>Hello, world</h1> bo'ladi
```

Ushbu HTML satr keyinchalik klientga yuborilishi mumkin, u sahifaning dastlabki markup’i sifatida ishlatiladi. JavaScript to'plam paketi klientda yuklangach, React DOM’ni hidratsiya qiladi, event handler’larni ulaydi va har qanday dinamik kontentni to'ldiradi.


### Seriyalashning ahamiyati
Seriyalash jarayoni bir necha sabablarga ko'ra muhimdir. Birinchi navbatda, bu serverga klientga tezda ko'rsatishga tayyor bo'lgan to'liq HTML sahifasini yuborishga imkon beradi. Bu sahifaning yuklanish vaqtini sezilarli darajada yaxshilaydi, chunki foydalanuvchilar kontent bilan tezroq o'zaro aloqada bo'lishlari mumkin.

Shuningdek, React elementlarini HTML satriga seriyalash muhitdan qat'i nazar, bir xil va bashorat qilinadigan dastlabki renderni ta'minlaydi. Yaratilgan HTML statikdir va serverda yoki klientda render qilinganda bir xil ko'rinishga ega bo'ladi. Ushbu muvofiqlik, dastlabki renderning oxirgi renderdan farq qilishi natijasida yuz berishi mumkin bo'lgan miltillashlar yoki joylashuv o'zgarishlarini oldini oladi, bu esa foydalanuvchi bilan ishlash qulayligini yaxshilashga yordam beradi.

Oxir-oqibat, seriyalash klient tomonida hidratsiyalash jarayonini osonlashtiradi. JavaScript to'plam paketi klientda yuklanganda, React event handler’larni ulash va har qanday dinamik kontentni to'ldirish kerak. Dastlabki markup sifatida seriyalashgan HTML satrini olish, React uchun ishonchli asosni ta'minlaydi va qayta hidratsiyalash jarayonini samarali va ishonchli qilishga yordam beradi.


### Seriyalash jarayoni
Biz komponentlarni satrlarga seriyalashimiz kerak, lekin shunchaki `JSON.stringify`dan foydalana olmaymiz, chunki React elementlari odatiy JavaScript obyektlari emas. Ular React tomonidan ularni aniqlash uchun ishlatiladigan maxsus $`$typeof` xususiyatiga ega. Ushbu xususiyatlarning qiymati esa symbol hisoblanadi. Symbol’ni esa seriyalash va tarmoq orqali yuborish mumkin emas, shuning uchun biz boshqa yo'l tutishimiz kerak.

Bu jarayonni amalga oshirish oson, chunki JavaScript ishchi muhitlarida, jumladan brauzer va Node.js’da bizga kerakli o'rnatilgan qo'llab-quvvatlash mavjud. Bu qo'llab-quvvatlash `JSON.stringify` va `JSON.parse` funksiyalari orqali taqdim etiladi. Ushbu funksiyalar JSON obyektlarini seriyalash yoki seriyadan chiqarish(deserelization) qilish uchun rekursiv tarzda ishlaydi, bu esa React elementlaridir. Ularning API’si quyidagicha:
``` js copy
JSON.stringify(object, replacer);
JSON.parse(object, replacer);
```

Bu yerda `replacer` funksiyasi kalit va qiymatni oladi va agar ba'zi shartlar bajarilsa, o'zgaruvchi qiymatni qaytarishi mumkin. Bizning holatimizda, biz `$$typeof` qiymatini seriyalash mumkin bo'lgan turga, masalan, string’ga almashtirmoqchimiz. Buni quyidagicha amalga oshiramiz:
``` js copy
JSON.stringify(jsxTree, (key, value) => {
  if (key === "$$typeof") {
    return "react.element"; // <- string!!
  }
  return value; // <- boshqa barcha qiymatlarni o'z holicha qaytaradi
});
```


### Seriyadan chiqarish (Deserelization)
Bu holatda biz tayyor! Klient tomonida bu jarayonni deserializatsiya qilish uchun, biz qarama-qarshi jarayonni bajaramiz:
``` js copy
JSON.parse(serializedJsxTree, (key, value) => {
  if (key === "$$typeof") {
    return Symbol.for("react.element"); // <- simbol!!
  }
  return value; // <- boshqa barcha qiymatlarni o'z holicha qaytar
});
```

Shu bilan biz React elementlarini seriyalash va deserializatsiya qilishimiz mumkin. Endi biz serverda server komponentlarini render qilamiz va ularni klientlarga yuboramiz. Bu dastlabki yuklashni hal qiladi; ammo, yangilanishlar va navigatsiya bilan ishlashimiz kerak. Avval navigatsiya bilan shug'ullanamiz va keyin yangilanishlarni ko'rib chiqamiz.
