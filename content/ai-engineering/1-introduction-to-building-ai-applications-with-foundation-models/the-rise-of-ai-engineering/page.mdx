# Sun'iy intellekt muhandisligining yuksalishi

Fundamental modellar katta til modellaridan, ular esa, o'z navbatida, oddiy til modellaridan kelib chiqqan. `ChatGPT` va `GitHub Copilot` kabi dasturlar go'yo hech qayerdan paydo bo'lib qolgandek tuyulsa-da, aslida ular o'nlab yillik texnologik taraqqiyotning mahsulidir, zero birinchi til modellari 1950-yillarda paydo bo'lgan. Ushbu bo'limda til modellaridan sun'iy intellekt muhandisligigacha bo'lgan evolyutsiyaga imkon bergan eng muhim yutuqlar batafsil ko'rib chiqiladi.

## Til modellari (_LM_) dan katta til modellari (_LLM_) ga

Til modellari ancha vaqtdan beri mavjud bo'lsa-da, ular faqatgina o'z-o'zini nazorat qilish (_self-supervision_) yordamidagina bugungi miqyosga erisha oldi. Ushbu qismda til modeli va o'z-o'zini nazorat qilish tushunchalari qisqacha sharhlanadi. Agar bu tushunchalar bilan allaqachon tanish bo'lsangiz, bu qismni o'tkazib yuborishingiz mumkin.

### Til modellari

Til modeli bir yoki bir nechta til haqidagi statistik ma'lumotlarni o'zida jamlaydi. Mohiyatan, bu ma'lumotlar biror so'zning ma'lum bir kontekstda paydo bo'lish ehtimoli qanchalik ekanligini bildiradi. Masalan, “Mening sevimli rangim __” degan kontekst berilganda, ingliz tilini o'zida jamlagan til modeli “mashina” so'ziga qaraganda “ko'k” so'zini ko'proq bashorat qilishi kerak.

Tillarning statistik tabiati asrlar oldin kashf etilgan. 1905-yilda yozilgan [“Raqsga tushayotgan odamchalar sarguzashti”](https://en.wikipedia.org/wiki/The_Adventure_of_the_Dancing_Men) hikoyasida Sherlok Holms sirli tayoqcha shakllar ketma-ketligining shifrini yechish uchun ingliz tilining oddiy statistik ma'lumotlaridan foydalangan. Ingliz tilida eng ko'p uchraydigan harf _E_ bo'lgani uchun, Holms eng ko'p uchraydigan tayoqcha shakli _E_ harfini anglatishi kerak degan xulosaga kelgan.

Keyinroq, Klod Shennon Ikkinchi jahon urushi paytida dushman xabarlarining shifrini ochish uchun yanada murakkabroq statistikadan foydalangan. Uning ingliz tilini qanday modellashtirish haqidagi ishi 1951-yilda chop etilgan va o'z davrida tub burilish yasagan [“Bosma ingliz tilining bashorati va entropiyasi”](https://www.kuenzigbooks.com/pages/books/28623/c-e-shannon-claude-elwood/prediction-and-entropy-of-printed-english-bell-monograph) (_"Prediction and Entropy of Printed English"_) nomli maqolasida nashr etilgan. Ushbu maqolada kiritilgan ko'plab tushunchalar, jumladan, entropiya, bugungi kunda ham til modellashtirishda qo'llaniladi.

Dastlabki paytlarda til modeli faqat bitta tilni o'z ichiga olardi. Biroq, bugungi kunda til modeli bir nechta tilni qamrab olishi mumkin.

Til modelining asosiy birligi — bu token. Token — bu modelga qarab, belgi, so'z yoki so'zning bir qismi (masalan, _-tion_ kabi) bo'lishi mumkin.[^1] Masalan, `ChatGPT` ortida turgan model — `GPT-4` — _“I can't wait to build AI applications”_ iborasini 1-1-rasmda ko'rsatilganidek, to'qqizta tokenga ajratadi. E'tibor bering, bu misolda _“can't”_ so'zi ikkita tokenga — _can_ va _t_'ga ajratilgan. Turli `OpenAI` modellarining matnni qanday tokenlarga ajratishini [`OpenAI` veb-saytida](https://platform.openai.com/tokenizer) ko'rishingiz mumkin.

![GPT-4 modeli "I can't wait to build AI applications" iborasini tokenlarga ajratish](/ai-engineering/1-chapter/1.1-figure.png)
<div className='text-center text-sm'>_1-1 rasm. GPT-4 modeli "I can't wait to build AI applications" iborasini tokenlarga ajratish_</div>

Asl matnni tokenlarga ajratish jarayoni **tokenizatsiya** deb ataladi. `GPT-4` uchun o'rtacha bitta token [so'z uzunligining taxminan ¾ qismiga](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them) teng. Demak, 100 ta token taxminan 75 ta so'zga to'g'ri keladi.

Model ishlay oladigan barcha tokenlar to'plami **modelning lug'ati** (_vocabulary_) deb ataladi. Xuddi alifbodagi sanoqli harflardan foydalanib ko'plab so'zlarni hosil qilish mumkin bo'lganidek, cheklangan miqdordagi tokenlar yordamida ham juda ko'p sonli turli xil so'zlarni yaratish mumkin. [`Mixtral 8x7B`](https://mistral.ai/news/mixtral-of-experts) modelining lug'at hajmi 32 000 tani tashkil etadi. `GPT-4`'ning lug'at hajmi esa [100 256](https://github.com/openai/tiktoken/blob/main/tiktoken/model.py) ga teng. Tokenizatsiya usuli va lug'at hajmi model yaratuvchilari tomonidan belgilanadi.

<Callout>
#### Eslatma

Nima uchun til modellari so'z yoki belgilar o'rniga tokenlardan foydalanadi? Buning uchta asosiy sababi bor:

1. **Ma'noli qismlarga ajratish.** Belgilarga nisbatan, tokenlar modelga so'zlarni ma'noli tarkibiy qismlarga ajratish imkonini beradi. Masalan, _“cooking”_ (pishirish) so'zini _“cook”_ (pishirmoq) va _“ing”_ (jarayonni bildiruvchi qo'shimcha) qismlariga ajratish mumkin, bunda ikkala qism ham asl so'zning ma'nosidan bir qismini o'zida saqlab qoladi.

2. **Samaradorlik.** Noyob tokenlar soni noyob so'zlar sonidan kamroq bo'lgani uchun, bu modelning lug'at hajmini qisqartiradi va uni yanada samaraliroq qiladi (bu haqda [2-bobda](/books/ai-engineering/2-understanding-foundation-models) muhokama qilinadi).

3. **Noma'lum so'zlarni qayta ishlash.** Tokenlar, shuningdek, modelga noma'lum so'zlarni qayta ishlashga yordam beradi. Masalan, _“chatgpting”_ kabi o'ylab topilgan so'zni _“chatgpt”_ va _“ing”_ qismlariga ajratish mumkin, bu esa modelga uning tuzilishini tushunishga yordam beradi. Shunday qilib, tokenlar bir tomondan birliklar sonini so'zlarga qaraganda kamroq ushlab tursa, ikkinchi tomondan, alohida belgilarga qaraganda ko'proq ma'no saqlab qolish o'rtasidagi muvozanatni ta'minlaydi.
</Callout>

Til modellarining ikkita asosiy turi mavjud: niqoblangan (_masked_) til modellari va avtoregressiv (_autoregressive_) til modellari. Bu ikki tur bir-biridan tokenni bashorat qilishda qanday ma'lumotlardan foydalanishi bilan ajralib turadi:

### Niqoblangan til modellari

Niqoblangan til modeli ketma-ketlikning istalgan joyidagi tushib qolgan tokenlarni, ham oldingi, ham keyingi kontekstdan foydalangan holda, bashorat qilishga o'rgatiladi. Mohiyatan, niqoblangan til modeli bo'sh joyni to'ldirishga o'rgatiladi. Masalan, “Mening sevimli __ ko'k” degan kontekst berilsa, niqoblangan til modeli bo'sh joy “rang” so'zi bo'lishi ehtimoli yuqori ekanligini bashorat qilishi kerak. Niqoblangan til modelining mashhur namunasi — bu transformatorlardan olingan ikki tomonlama kodlovchi tasvirlar (_bidirectional encoder representations from transformers_), ya'ni `BERT` ([Devlin va boshq., 2018](https://arxiv.org/abs/1810.04805)).

Ushbu kitob yozilayotgan vaqtda, niqoblangan til modellari odatda hissiyot tahlili (_sentiment analysis_) va matn tasnifi (_text classification_) kabi generativ bo'lmagan vazifalar uchun qo'llaniladi. Ular, shuningdek, koddagi xatolarni tuzatish (_code debugging_) kabi umumiy kontekstni tushunishni talab qiladigan vazifalar uchun ham foydalidir, chunki bunda model xatolarni aniqlash uchun ham oldingi, ham keyingi kodni tushunishi kerak bo'ladi.

### Avtoregressiv til modellari

Avtoregressiv til modeli ketma-ketlikdagi keyingi tokenni faqat o'zidan oldingi tokenlardan foydalangan holda bashorat qilishga o'rgatiladi. U “Mening sevimli rangim __” jumlasida keyin nima kelishini bashorat qiladi.[^2] Avtoregressiv model uzluksiz ravishda birin-ketin token generatsiya qila oladi. Bugungi kunda avtoregressiv til modellari matn generatsiyasi uchun eng maqbul modellar hisoblanadi va shu sababli ular niqoblangan til modellariga qaraganda ancha ommaboproqdir.[^3]

1-2-rasmda til modellarining bu ikki turi ko'rsatilgan.

![1-2-rasm. Avtoregressiv til modeli va niqoblangan til modeli](/ai-engineering/1-chapter/1.2-figure.png)

<div className='text-center text-sm'>_1-2 rasm. Avtoregressiv til modeli va niqoblangan til modeli_</div>

<Callout>
#### Eslatma

Ushbu kitobda, agar alohida ta'kidlanmagan bo'lsa, “til modeli” deganda avtoregressiv model nazarda tutiladi.
</Callout>

Til modellarining natijalari erkin va cheklanmagandir. Til modeli o'zining qat'iy, cheklangan lug'atidan foydalanib, cheksiz miqdordagi ehtimoliy natijalarni yarata oladi. Erkin natijalar generatsiya qila oladigan model **generativ** deb ataladi, shu sababli **generativ _SI_** atamasi kelib chiqqan.

Til modelini bir **to'ldiruvchi mashina** deb tasavvur qilish mumkin: unga biror matn (_prompt_) berilsa, u shu matnni to'ldirishga harakat qiladi. Mana bir misol:

``` txt
`Prompt (foydalanuvchidan)`: "Bo'lmoq yoki bo'lmaslik"
`Davomi (til modelidan)`: ", mana masalaning asl mohiyati."
```

Shuni ta'kidlash muhimki, bu to'ldirmalar ehtimolliklarga asoslangan bashoratlar bo'lib, ularning to'g'ri bo'lishi kafolatlanmagan. Til modellarining aynan shu ehtimoliy tabiati ulardan foydalanishni bir vaqtning o'zida ham hayajonli, ham asabiylashtiruvchi qiladi. Bu mavzuni 2-bobda yanada chuqurroq o'rganamiz.

Garchi sodda eshitilsa-da, to'ldirish jarayoni nihoyatda qudratli imkoniyatdir. Tarjima, qisqacha bayon qilish, kod yozish va matematik masalalarni yechish kabi ko'plab vazifalarni to'ldirish vazifalari sifatida ifodalash mumkin. Masalan, “Fransuz tilida 'ahvollaringiz qalay' … degani” prompti berilganda, til modeli uni _“Comment ça va”_ bilan to'ldirishi mumkin, bu esa bir tildan ikkinchisiga samarali tarjima qilish demakdir.

Yana bir misol, quyidagi prompt berilganda:

``` txt
`Savol`: "Ushbu elektron pochta spam bo'lishi ehtimoli bormi? Xatning matni: <elektron pochta matni>"
`Javob`:
```

Til modeli uni “Ehtimoliy spam” deb to'ldirishi mumkin, bu esa o'z navbatida til modelini spam-klassifikatorga aylantiradi.

To'ldirish qudratli bo'lsa-da, bu suhbat qurish bilan bir xil narsa emas. Masalan, agar siz to'ldiruvchi mashinaga savol bersangiz, u savolga javob berish o'rniga, sizning gapingizni yana bir savol qo'shish orqali to'ldirishi mumkin. ["Qo'shimcha o'qitish" (_Post-Training_)](/books/ai-engineering/2-understanding-foundation-models/post-training) bo'limida modelni foydalanuvchi so'roviga qanday qilib munosib javob berishga o'rgatish muhokama qilinadi.

### O'z-o'zini nazorat qilish (Self-supervision)

Til modellashtirish — bu ko'plab _ML_ algoritmlaridan faqat bittasigina xolos. Bundan tashqari, obyektlarni aniqlash, mavzularni modellashtirish, tavsiya tizimlari, ob-havoni bashorat qilish, aksiya narxlarini taxmin qilish va hokazolar uchun ham modellar mavjud. Xo'sh, til modellarining boshqa ko'plab _ML_ algoritmlaridan qanday afzalligi bor va nima ularni `ChatGPT` inqilobiga olib kelgan miqyoslash yondashuvining markaziga aylantirdi?

Javob shundaki, til modellarini o'z-o'zini nazorat qilish (_self-supervision_) yordamida o'qitish mumkin, holbuki, boshqa ko'plab modellar nazoratli o'qitishni (_supervision_) talab qiladi. Nazoratli o'qitish — bu _ML_ algoritmlarini maxsus belgilangan ma'lumotlar yordamida o'qitish jarayonidir va bunday ma'lumotlarni to'plash qimmatga tushishi va ko'p vaqt talab qilishi mumkin. O'z-o'zini nazorat qilish esa aynan shu ma'lumotlarni belgilashdagi to'siqni yengib o'tishga yordam beradi. Bu esa, o'z navbatida, modellarga o'rganish uchun kattaroq ma'lumotlar to'plamlarini yaratish va ularning miqyosini samarali ravishda kengaytirish imkonini beradi. Keling, buni batafsil ko'rib chiqamiz.

Nazoratli o'qitishda siz model o'rganishi kerak bo'lgan xususiyatlarni ko'rsatish uchun namunalarni belgilab chiqasiz va keyin modelni shu namunalar asosida o'qitasiz. O'qitib bo'lingach, modelni yangi ma'lumotlarga qo'llash mumkin bo'ladi. Masalan, firibgarlikni aniqlash modelini o'qitish uchun siz har biri “firibgarlik” yoki “firibgarlik emas” deb belgilangan tranzaksiyalar namunalaridan foydalanasiz. Model bu namunalardan o'rganib olgach, siz undan yangi tranzaksiyaning firibgarlik ekanligini bashorat qilish uchun foydalanishingiz mumkin.

2010-yillarda _SI_ modellarining muvaffaqiyati aynan nazoratli o'qitishga asoslangan edi. Chuqur o'rganish (_deep learning_) inqilobini boshlab bergan model — _AlexNet_ ([Krizhevsky va boshq., 2012](https://proceedings.neurips.cc/paper_files/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf)) — nazoratli o'qitishga asoslangan edi. U _ImageNet_ ma'lumotlar to'plamidagi 1 milliondan ortiq rasmni tasniflashni o'rganish uchun o'qitilgan. U har bir rasmni “mashina”, “havo shari” yoki “maymun” kabi 1000 ta toifadan biriga ajratgan.

Nazoratli o'qitishning kamchiligi shundaki, ma'lumotlarni belgilash qimmat va ko'p vaqt talab qiladigan jarayondir. Agar bir kishi bitta rasmni belgilashi uchun 5 sent ketsa, _ImageNet_ uchun millionta rasmni belgilash 50 000 dollarga tushadi.[^4] Agar siz har bir rasmni ikki xil odam belgilashini istasangiz — bu orqali belgilash sifatini qayta tekshirish mumkin bo'ladi — xarajat ikki baravar oshadi. Dunyoda 1000 tadan ancha ko'p obyekt mavjudligini hisobga olsak, modellarning imkoniyatlarini ko'proq obyektlar bilan ishlashga kengaytirish uchun siz ko'proq toifalarga oid belgilarni qo'shishingiz kerak bo'ladi. Miqyosni 1 million toifaga yetkazish uchun esa, faqat belgilash xarajatining o'zi 50 million dollarga yetadi.

Kundalik obyektlarni belgilashni ko'pchilik odamlar maxsus tayyorgarliksiz ham bajara oladi. Shu sababli, buni nisbatan arzon amalga oshirish mumkin. Biroq, hamma belgilash vazifalari ham bunchalik oson emas. Ingliz tilidan lotin tiliga tarjima qiluvchi model uchun lotincha tarjimalarni yaratish ancha qimmatroq. Kompyuter tomografiyasi (_CT scan_) suratida saraton belgilari bor-yo'qligini belgilash esa tasavvur qilib bo'lmas darajada qimmatga tushardi.

O'z-o'zini nazorat qilish ma'lumotlarni belgilashdagi bu to'siqni yengib o'tishga yordam beradi. O'z-o'zini nazorat qilishda model aniq belgilarni talab qilish o'rniga, belgilarni kiruvchi ma'lumotlarning o'zidan chiqarib oladi. Til modellashtirish o'z-o'zini nazorat qilishga asoslanadi, chunki har bir kiruvchi ketma-ketlik ham belgilarni (bashorat qilinishi kerak bo'lgan tokenlarni), ham model bu belgilarni bashorat qilish uchun foydalanishi mumkin bo'lgan kontekstni o'zida mujassam etadi. Masalan, "Men ko'cha taomlarini yaxshi ko'raman." (_"I love street food."_) jumlasi 1-1-jadvalda ko'rsatilganidek, oltita o'qitish namunasini beradi.

| Kirish (kontekst) | Chiqish (keyingi token) |
| :--- | :--- |
| `<BOS>` | `I` |
| `<BOS>, I` | `love` |
| `<BOS>, I, love` | `street` |
| `<BOS>, I, love, street` | `food` |
| `<BOS>, I, love, street, food` | `.` |
| `<BOS>, I, love, street, food, .` | `<EOS>` |

<div className='text-center text-sm italic'>1-1 jadval. _"I love street food."_ jumlasidan til modellashtirish uchun olingan o'qitish namunalari.</div>

1-1-jadvalda `<BOS>` va `<EOS>` ketma-ketlikning boshlanishi va tugashini bildiradi. Bu belgilar til modelining bir nechta ketma-ketliklar bilan ishlashi uchun zarur. Har bir belgi odatda model tomonidan bitta maxsus token sifatida qabul qilinadi. Ketma-ketlikning tugash belgisi ayniqsa muhim, chunki u til modellariga o'z javoblarini qachon tugatish kerakligini bilishga yordam beradi.[^5]

<Callout>
#### Eslatma

O'z-o'zini nazorat qilish (_self-supervision_) nazoratsiz o'qitishdan (_unsupervision_) farq qiladi. O'z-o'zini nazorat qilishda belgilar kiruvchi ma'lumotlarning o'zidan chiqarib olinsa, nazoratsiz o'qitishda esa belgilarga umuman hojat yo'q.
</Callout>

O'z-o'zini nazorat qilish til modellarining hech qanday belgilashni talab qilmasdan, to'g'ridan-to'g'ri matn ketma-ketliklaridan o'rganishini anglatadi. Matn ketma-ketliklari hamma joyda — kitoblarda, blog postlarida, maqolalarda va Reddit izohlarida — mavjud bo'lgani uchun, ulkan hajmdagi o'qitish ma'lumotlarini to'plash mumkin. Bu esa til modellarining miqyosini kengaytirib, katta til modellariga (_LLM_) aylanishiga imkon beradi.

Biroq, _LLM_ atamasi ilmiy jihatdan unchalik aniq emas. Til modeli “katta” deb hisoblanishi uchun qanchalik katta bo'lishi kerak? Bugun katta deb hisoblangan narsa ertaga kichik bo'lib qolishi mumkin. Modelning hajmi odatda uning parametrlari soni bilan o'lchanadi. Parametr — bu _ML_ modelidagi o'zgaruvchi bo'lib, u o'qitish jarayonida yangilanib boradi.[^6] Umuman olganda, garchi bu har doim ham to'g'ri bo'lmasa-da, modelda qancha ko'p parametr bo'lsa, uning kerakli xususiyatlarni o'rganish salohiyati shuncha yuqori bo'ladi.

2018-yil iyun oyida OpenAI'ning birinchi generativ oldindan o'qitilgan transformeri (`GPT`) chiqqanida, uning 117 million parametri bor edi va bu katta hisoblanardi. 2019-yil fevral oyida OpenAI 1.5 milliard parametrli `GPT-2`'ni taqdim etganida, 117 million endi kichik deb hisoblana boshlandi. Ushbu kitob yozilayotgan vaqtda, 100 milliard parametrli model katta hisoblanadi. Balki bir kun kelib bu hajm ham kichik bo'lib qolar.

Keyingi bo'limga o'tishdan oldin, odatda e'tibordan chetda qoladigan bir savolga to'xtalib o'tmoqchiman: _Nima uchun kattaroq modellarga ko'proq ma'lumot kerak?_ Kattaroq modellar o'rganish uchun ko'proq salohiyatga ega, shuning uchun ularning samaradorligini maksimal darajaga chiqarish uchun ko'proq o'qitish ma'lumotlari kerak bo'ladi.[^7] Katta modelni kichik ma'lumotlar to'plamida ham o'qitish mumkin, lekin bu hisoblash resurslarini behuda sarflash bo'ladi. Bu ma'lumotlar to'plamida kichikroq modellar yordamida ham xuddi shunday yoki undan ham yaxshiroq natijalarga erishish mumkin edi.

## Katta til modellari (_LLM_) dan fundamental modellarga

Til modellari misli ko'rilmagan vazifalarni bajara olsa-da, ular matn bilan cheklangan. Biz, insonlar, dunyoni nafaqat til orqali, balki ko'rish, eshitish, sezish va boshqa tuyg'ular yordamida idrok etamiz. Matndan tashqari ma'lumotlarni qayta ishlay olish _SI_'ning real dunyoda faoliyat yuritishi uchun juda muhimdir.

Shu sababli, til modellari ko'proq ma'lumot modalliklarini o'z ichiga olish uchun kengaytirilmoqda. `GPT-4V` va `Claude 3` kabi modellar ham tasvirlarni, ham matnlarni tushuna oladi. Ba'zi modellar hatto videolar, 3D obyektlar, oqsil tuzilmalari va hokazolarni ham tushunadi. Til modellariga ko'proq ma'lumot modalliklarini qo'shish ularni yanada qudratliroq qiladi. "OpenAI" 2023-yilda [o'zining `GPT-4V` tizimi haqidagi hisobotida](https://cdn.openai.com/papers/GPTV_System_Card.pdf) shunday degan edi: “_LLM_'larga qo'shimcha modalliklarni (masalan, tasvirli kiritishlarni) qo'shish ba'zilar tomonidan _SI_ tadqiqotlari va ishlanmalaridagi asosiy, ilg'or yo'nalishlardan biri sifatida qaralmoqda.”

Garchi ko'pchilik `Gemini` va `GPT-4V`'ni hali ham _LLM_ deb atasa-da, ularni [fundamental modellar](https://arxiv.org/abs/2108.07258) deb ta'riflash to'g'riroq bo'ladi. “Fundamental” so'zi ham bu modellarning _SI_ dasturlaridagi muhimligini, ham ularning asosida turli ehtiyojlar uchun yangi narsalar qurish mumkinligini anglatadi.

Fundamental modellar _SI_ tadqiqotlarining an'anaviy tuzilishida yangi bir bosqichni boshlab berdi. Uzoq vaqt davomida _SI_ tadqiqotlari ma'lumot modalliklari bo'yicha bo'lingan edi. Tabiiy tilni qayta ishlash (_NLP_) faqat matn bilan shug'ullanardi. Kompyuter ko'rishi (_Computer vision_) faqat tasvir bilan shug'ullanardi. Faqat matn bilan ishlaydigan modellar tarjima va spamni aniqlash kabi vazifalar uchun ishlatilishi mumkin edi. Faqat tasvir bilan ishlaydigan modellar esa obyektlarni aniqlash va tasvirlarni tasniflash uchun ishlatilardi. Faqat audio bilan ishlaydigan modellar nutqni aniqlash (nutqdan-matnga yoki _STT_) va nutq sintezi (matndan-nutqqa yoki _TTS_) kabi vazifalarni bajara olardi.

Birdan ortiq ma'lumot modalligi bilan ishlay oladigan model **multimodal model** deb ham ataladi. Generativ multimodal model esa **katta multimodal model** (_LMM_) deyiladi. Agar til modeli keyingi tokenni faqat matnli tokenlarga asoslanib generatsiya qilsa, multimodal model keyingi tokenni ham matn, ham tasvir tokenlariga, ya'ni model qo'llab-quvvatlaydigan barcha modalliklarga asoslanib generatsiya qiladi (1-3-rasm).

![](/ai-engineering/1-chapter/1.3-figure.png)

<div className='text-center text-sm italic'>1-3-rasm. Multimodal model keyingi tokenni ham matn, ham vizual tokenlardan olingan ma'lumotlar asosida generatsiya qila oladi</div>

Til modellari singari, multimodal modellar ham miqyoslash uchun ma'lumotlarga muhtoj. O'z-o'zini nazorat qilish yondashuvi multimodal modellar uchun ham ishlaydi. Masalan, OpenAI o'zining til-tasvir modeli bo'lgan `CLIP`'ni o'qitish uchun o'z-o'zini nazorat qilishning tabiiy til nazorati (_natural language supervision_) deb nomlangan bir turidan foydalangan ([OpenAI, 2021](https://openai.com/index/clip/)). Ular har bir tasvir uchun yorliqlarni mustaqil yaratish o'rniga, internetda birga uchraydigan (tasvir, matn) juftliklarini topdilar. Ular mustaqil belgilash xarajatlarisiz 400 million (tasvir, matn) juftligidan iborat ma'lumotlar to'plamini yarata oldilar, bu esa _ImageNet_'dan 400 baravar kattaroq edi. Bu ma'lumotlar to'plami `CLIP`'ning qo'shimcha o'qitishni talab qilmasdan, bir nechta tasvir tasnifi vazifalariga umumlashtira oladigan birinchi modelga aylanishiga imkon berdi.

<Callout>
#### Eslatma

Ushbu kitobda fundamental modellar atamasi ham katta til modellari, ham katta multimodal modellarni anglatadi.
</Callout>

Shuni ta'kidlash joizki, `CLIP` generativ model emas — u erkin natijalar generatsiya qilishga o'rgatilmagan. `CLIP` — bu ham matnlar, ham tasvirlarning qo'shma _embedding_'larini hosil qilishga o'rgatilgan _embedding_ modelidir (_embedding_ — bu so'z yoki tasvir kabi murakkab ma'lumotni ma'nosini saqlagan holda ixcham raqamli ko'rinishga, ya'ni vektorga o'tkazish jarayoni). “_Embedding_'larga kirish” bo'limida _embedding_'lar batafsil muhokama qilinadi. Hozircha, _embedding_'larni asl ma'lumotlarning ma'nosini o'zida aks ettirishga harakat qiladigan vektorlar deb tasavvur qilishingiz mumkin. `CLIP` kabi multimodal _embedding_ modellari `Flamingo`, `LLaVA` va `Gemini` (avvalgi `Bard`) singari generativ multimodal modellarning asosini, ya'ni tayanchini tashkil etadi.

### Maxsus vazifali modellardan umumiy maqsadli modellarga

Fundamental modellar, shuningdek, maxsus vazifali modellardan umumiy maqsadli modellarga o'tish davrini ham anglatadi. Ilgari modellar ko'pincha hissiyot tahlili (_sentiment analysis_) yoki tarjima kabi maxsus vazifalar uchun ishlab chiqilardi. Hissiyot tahlili uchun o'qitilgan model tarjima qila olmasdi va aksincha.

Fundamental modellar o'zlarining miqyosi va o'qitilish usuli tufayli juda keng doiradagi vazifalarni bajara oladi. Tayyor holatida, umumiy maqsadli modellar ko'plab vazifalarni nisbatan yaxshi bajara oladi. _LLM_ ham hissiyot tahlilini, ham tarjimani bajara oladi. Biroq, ko'p hollarda umumiy maqsadli modelni biror maxsus vazifa uchun uning samaradorligini maksimal darajaga chiqarish maqsadida biroz o'zgartirish (_tweak_ qilish) mumkin.

1-4-rasmda fundamental modellarni baholash uchun _Super-NaturalInstructions_ benchmarkida ishlatiladigan vazifalar ko'rsatilgan va bu fundamental model qanday turdagi vazifalarni bajara olishi haqida tasavvur beradi ([Wang va boshq., 2022](https://arxiv.org/abs/2204.07705)).

Tasavvur qiling, siz bir chakana savdo kompaniyasi bilan ularning veb-sayti uchun mahsulot tavsiflarini generatsiya qiladigan dastur ustida ishlayapsiz. Tayyor holatidagi model to'g'ri tavsiflarni generatsiya qilishi mumkin, lekin brendning o'ziga xos ovozini (_voice_) aks ettira olmasligi yoki brendning asosiy g'oyalarini (_messaging_) ta'kidlay olmasligi mumkin. Generatsiya qilingan tavsiflar hatto marketing nutqi va siyqasi chiqqan iboralarga (_cliches_) to'la bo'lishi ham mumkin.

![Super-NaturalInstructions benchmarkidagi vazifalar doirasi (Wang va boshq., 2022)](/ai-engineering/1-chapter/1.4-figure.png)

<div className='text-center text-sm italic'>1-4-rasm. _Super-NaturalInstructions_ benchmarkidagi vazifalar doirasi (Wang va boshq., 2022).</div>

### Modelni vazifaga moslashtirish

Modeldan o'zingiz istagan natijani olish uchun qo'llashingiz mumkin bo'lgan bir nechta texnikalar mavjud. Masalan, siz kerakli mahsulot tavsiflariga oid misollar bilan boyitilgan batafsil ko'rsatmalar ishlab chiqishingiz mumkin. Bu yondashuv prompt muhandisligi (_prompt engineering_) deb ataladi. Yoki modelni mijozlarning fikr-mulohazalari bazasiga ulashingiz mumkin, model esa bu ma'lumotlardan dastak sifatida foydalanib, yanada yaxshiroq tavsiflar generatsiya qiladi. Ko'rsatmalarni ma'lumotlar bazasi bilan to'ldirish qidiruv bilan boyitilgan generatsiya (_Retrieval-Augmented Generation_, _RAG_) deb nomlanadi. Shuningdek, siz modelni yuqori sifatli mahsulot tavsiflari to'plamida _finetuning_ qilish, ya'ni qo'shimcha o'qitish imkoniga ham egasiz.

### Tayyor modeldan foydalanish yoki o'zi yaratish?

Prompt muhandisligi, _RAG_ va  _finetuning_ qilish — bular modelni o'z ehtiyojlaringizga moslashtirish uchun ishlatishingiz mumkin bo'lgan, sun'iy intellekt muhandisligidagi uchta eng keng tarqalgan texnikadir. Kitobning qolgan qismida ularning barchasi batafsil muhokama qilinadi.

Mavjud qudratli modelni o'z vazifangizga moslashtirish, odatda, noldan yangi model yaratishdan ancha oson. Tasavvur qiling: bir tomonda 1 million namuna va olti oylik mehnat, ikkinchi tomonda esa atigi o'nta namuna va bir dam olish kuni. Fundamental modellar _SI_ ilovalarini yaratish xarajatlarini kamaytiradi va yechimni bozorga olib chiqish muddatini (_time to market_) sezilarli darajada qisqartiradi. Modelni moslashtirish uchun qancha ma'lumot kerakligi esa siz tanlagan usulga bog'liq bo'ladi. Ushbu kitobda har bir usulni muhokama qilar ekanmiz, bu savolga ham alohida to'xtalib o'tamiz. Shunga qaramay, muayyan vazifaga ixtisoslashgan modellarning ham o'ziga yarasha afzalliklari ko'p: masalan, ular ancha ixcham bo'lishi mumkin, bu esa ulardan foydalanishni tezroq va arzonroq qiladi.

O'z modelingizni yaratish yoki mavjudidan foydalanish — bu jamoalar o'zlari javob topishlari kerak bo'lgan klassik "sotib olish yoki o'zi yaratish" masalasidir. Kitob davomidagi muhokamalar bu qarorni qabul qilishga yordam beradi.

## Fundamental modellardan sun'iy intellekt muhandisligiga

Sun'iy intellekt muhandisligi (_AI Engineering_) fundamental modellar asosida dasturlar yaratish jarayonini anglatadi. Odamlar o'n yildan oshiq vaqtdan beri _SI_ dasturlarini yaratib kelishadi — bu jarayon ko'pincha _ML_ muhandisligi yoki _MLOps_ (_ML operatsiyalari_ qisqartmasi) deb nomlanadi. Xo'sh, nega endi aynan sun'iy intellekt muhandisligi haqida gapiryapmiz?

Agar an'anaviy _ML_ muhandisligi _ML_ modellarini ishlab chiqishni o'z ichiga olsa, sun'iy intellekt muhandisligi mavjudlaridan dastak sifatida foydalanadi. Qudratli fundamental modellarning mavjudligi va ochiqligi birgalikda sun'iy intellekt muhandisligining bir yo'nalish sifatida jadal rivojlanishi uchun ideal sharoitlarni yaratadigan uchta omilga olib keldi:

### 1-omil: Umumiy maqsadli _SI_ imkoniyatlari

Fundamental modellar nafaqat mavjud vazifalarni yaxshiroq bajara olgani uchun, balki ko'proq vazifalarni bajara olgani uchun ham qudratlidir. Ilgari imkonsiz deb hisoblangan dasturlar endi mumkin bo'lib qoldi, ilgari o'ylab ham ko'rilmagan dasturlar paydo bo'lmoqda. Hatto bugun imkonsiz deb hisoblangan dasturlar ertaga mumkin bo'lib qolishi ham hech gap emas. Bu esa _SI_'ni hayotning ko'proq jabhalari uchun foydaliroq qiladi va ham foydalanuvchilar bazasini, ham _SI_ dasturlariga bo'lgan talabni keskin oshiradi.

Masalan, _SI_ endi insonlar kabi, ba'zan esa ulardan ham yaxshiroq yoza olgani uchun, u muloqotni talab qiladigan har bir vazifani avtomatlashtirishi yoki qisman avtomatlashtirishi mumkin — bu esa deyarli hamma narsani anglatadi. _SI_ elektron pochta xabarlarini yozish, mijozlar so'rovlariga javob berish va murakkab shartnomalarni tushuntirish uchun ishlatilmoqda. Kompyuterga ega bo'lgan har bir kishi marketing materiallarini yaratish, professional portret suratlarni tahrirlash, san'at konsepsiyalarini vizualizatsiya qilish, kitoblarni illustratsiya qilish va hokazolarda yordam beradigan moslashtirilgan, yuqori sifatli tasvirlar va videolarni bir zumda generatsiya qila oladigan vositalarga ega. _SI_ hatto o'qitish ma'lumotlarini sintez qilish, algoritmlar ishlab chiqish va kod yozish uchun ham ishlatilishi mumkin, bularning barchasi kelajakda yanada qudratliroq modellarni o'qitishga yordam beradi.

### 2-omil: _SI_ sohasiga investitsiyalarning ortishi

`ChatGPT`'ning muvaffaqiyati ham venchur kapitalistlar, ham korporatsiyalar tomonidan _SI_ sohasiga kiritilayotgan investitsiyalarning keskin ortishiga turtki bo'ldi. _SI_ dasturlarini yaratish arzonlashib, bozorga chiqish tezlashgani sari, _SI_'ga kiritilgan sarmoyadan olinadigan daromad ham jozibadorroq bo'lib bormoqda. Kompaniyalarning barchasi o'z mahsulotlari va jarayonlariga _SI_'ni joriy etishga shoshilmoqda. Scribd kompaniyasining amaliy tadqiqotlar bo'yicha katta menejeri Mett Rossning menga aytishicha, uning ishlatilish senariylari uchun taxminiy _SI_ xarajatlari 2022-yil aprelidan 2023-yil apreligacha bo'lgan davrda 100 baravarga kamaygan.

["Goldman Sachs Research"](https://www.goldmansachs.com/insights/articles/ai-investment-forecast-to-approach-200-billion-globally-by-2025.html) hisob-kitoblariga ko'ra, 2025-yilga kelib _SI_ investitsiyalari AQSHda 100 milliard dollarga, global miqyosda esa 200 milliard dollarga yaqinlashishi mumkin.[^8] _SI_ ko'pincha raqobatbardosh ustunlik sifatida tilga olinadi. [FactSet](https://insight.factset.com/highest-number-of-sp-500-companies-citing-ai-on-q2-earnings-calls-in-over-10-years) tadqiqotiga ko'ra, 2023-yilning ikkinchi choragida _S&P 500_ kompaniyalarining har uchdan biri o'zlarining daromadlari haqidagi hisobotlarida _SI_'ni tilga olgan — bu ko'rsatkich o'tgan yilgiga nisbatan uch baravar ko'pdir. 1-5-rasmda 2018-yildan 2023-yilgacha bo'lgan davrda o'z daromadlari haqidagi hisobotlarida _SI_'ni tilga olgan _S&P 500_ kompaniyalari soni ko'rsatilgan.

![O'z daromadlari haqidagi hisobotlarida _SI_'ni tilga olgan _S&P 500_ kompaniyalari soni 2023-yilda rekord darajaga yetdi. Ma'lumotlar FactSetdan olingan](/ai-engineering/1-chapter/1.5-figure.png)

<div className='text-center text-sm italic'>1-5-rasm. O'z daromadlari haqidagi hisobotlarida _SI_'ni tilga olgan _S&P 500_ kompaniyalari soni 2023-yilda rekord darajaga yetdi. Ma'lumotlar FactSet'dan olingan.</div>

WallStreetZen ma'lumotlariga ko'ra, o'z daromadlari haqidagi hisobotlarida _SI_'ni tilga olgan kompaniyalarning aksiya narxlari tilga olmaganlarga qaraganda ko'proq o'sgan: [2.4% ga nisbatan o'rtacha 4.6% o'sdi](https://www.theregister.com/2023/09/18/mention_ai_in_earnings_calls/). Bu sabab-oqibat bog'liqligimi (_SI_ bu kompaniyalarni muvaffaqiyatliroq qilmoqda) yoki shunchaki korrelyatsiyami (kompaniyalar yangi texnologiyalarga tez moslashgani uchun muvaffaqiyatli), bu hali noaniq.

### 3-omil: _SI_ dasturlarini yaratish uchun kirish to'sig'ining pastligi

OpenAI va boshqa model provayderlari tomonidan ommalashtirilgan "xizmat sifatida taqdim etiluvchi model" yondashuvi _SI_'dan foydalanib dasturlar yaratishni ancha osonlashtiradi. Bu yondashuvda modellar foydalanuvchi so'rovlarini qabul qiluvchi va model natijalarini qaytaruvchi _API_'lar orqali taqdim etiladi. Bu _API_'larsiz _SI_ modelidan foydalanish ushbu modelni o'z serverlarida ishga tushirish va xizmat ko'rsatish uchun maxsus infratuzilmani talab qiladi. _API_'lar esa sizga oddiy _API_ chaqiruvlari orqali qudratli modellardan foydalanish imkonini beradi.

Nafaqat bu, _SI_ minimal darajada kod yozish bilan ham dasturlar yaratish imkonini beradi. Birinchidan, _SI_ siz uchun kod yoza oladi, bu esa dasturiy ta'minot muhandisligi bo'yicha tajribasi bo'lmagan odamlarga o'z g'oyalarini tezda kodga aylantirish va ularni foydalanuvchilarga taqdim etish imkonini beradi. Ikkinchidan, siz bu modellar bilan biror dasturlash tilidan foydalanish o'rniga, oddiy ingliz tilida ishlashingiz mumkin. _Endi har kim, ha, istalgan odam _SI_ dasturlarini yarata oladi_.

### _SI_ muhandisligining portlashi

Fundamental modellarni ishlab chiqish uchun talab etiladigan resurslar tufayli, bu jarayon faqat yirik korporatsiyalar (Google, Meta, Microsoft, Baidu, Tencent), hukumatlar ([Yaponiya](https://www.nii.ac.jp/en/news/release/2023/1020.html), [BAA](https://www.ft.com/content/ab36d481-9e7c-4d18-855d-7d313db0db0d)) va ambitsiyali, yaxshi moliyalashtirilgan startaplar (OpenAI, Anthropic, Mistral) uchungina mumkin. 2022-yil sentabr oyidagi intervyusida [OpenAI bosh direktori Sem Altman](https://greylock.com/greymatter/sam-altman-ai-for-the-next-era/) aksariyat odamlar uchun eng katta imkoniyat bu modellarni maxsus dasturlarga moslashtirish bo'lishini aytgan.

Dunyo bu imkoniyatni tezda qabul qildi. Sun'iy intellekt muhandisligi eng tez, balki eng jadal rivojlanayotgan muhandislik yo'nalishi sifatida maydonga chiqdi. Sun'iy intellekt muhandisligi uchun vositalar avvalgi har qanday dasturiy ta'minot muhandisligi vositalariga qaraganda tezroq ommalashmoqda. Atigi ikki yil ichida to'rtta ochiq manbali _SI_ muhandislik vositasi (`AutoGPT`, `Stable Diffusion web UI`, `LangChain`, `Ollama`) GitHub'da Bitcoin'dan ko'ra ko'proq yulduzcha to'plab ulgurdi. Ular yulduzchalar soni bo'yicha hatto eng mashhur veb-ishlab chiqish freymvorklari, jumladan React va Vue'ni ham ortda qoldirish arafasida. 1-6-rasmda _SI_ muhandislik vositalarining GitHub yulduzchalari o'sishi Bitcoin, Vue va React bilan taqqoslangan.

LinkedIn'ning 2023-yil avgust oyidagi so'rovnomasi shuni ko'rsatadiki, o'z profiliga “Generativ _SI_,” “ChatGPT,” “Prompt Muhandisligi,” va “Prompt Yaratish” kabi atamalarni qo'shgan mutaxassislar soni har oy o'rtacha 75% ga oshgan. ComputerWorld esa “SI'ni o'zini tutishga o'rgatish — eng tez o'sayotgan karyera ko'nikmasi” deb e'lon qildi.

![Ochiq manbali _SI_ muhandislik vositalari GitHub yulduzchalari soniga ko'ra boshqa har qanday dasturiy ta'minot muhandisligi vositalariga qaraganda tezroq o'smoqda](/ai-engineering/1-chapter/1.6-figure.png)

<div className='text-center text-sm italic'>1-6-rasm. Ochiq manbali _SI_ muhandislik vositalari GitHub yulduzchalari soniga ko'ra boshqa har qanday dasturiy ta'minot muhandisligi vositalariga qaraganda tezroq o'smoqda.</div>

### Nega aynan “Sun'iy intellekt muhandisligi” atamasi?

> Fundamental modellar asosida dasturlar yaratish jarayonini tasvirlash uchun ko'plab atamalar qo'llanilmoqda, jumladan, _ML_ muhandisligi, _MLOps_, _AIOps_, _LLMOps_ va hokazo. Xo'sh, nima uchun men bu kitob uchun aynan sun'iy intellekt muhandisligi atamasini tanladim?
>
> Men _ML_ muhandisligi atamasini tanlamadim, chunki [“SI muhandisligi va _ML_ muhandisligi farqlari”](/books/ai-engineering/1-introduction-to-building-ai-applications-with-foundation-models/ai-engineering-stack#si-muhandisligi-va-ml-muhandisligi-farqlari) bo'limida muhokama qilinganidek, fundamental modellar bilan ishlash an'anaviy _ML_ modellari bilan ishlashdan bir nechta muhim jihatlari bilan farq qiladi. _ML_ muhandisligi atamasi bu farqni to'liq ifodalash uchun yetarli bo'lmaydi. Shunday bo'lsa-da, _ML_ muhandisligi ikkala jarayonni ham qamrab oluvchi ajoyib umumiy atamadir.
>
> Men “Ops” bilan tugaydigan atamalarning barchasidan voz kechdim, chunki jarayonda operatsion qismlar mavjud bo'lsa-da, asosiy e'tibor fundamental modellarni siz xohlagandek ishlashi uchun sozlashga (ya'ni, muhandislikka) qaratilgan.
>
> Va nihoyat, men fundamental modellar asosida dasturlar ishlab chiqayotgan 20 kishidan ular o'z faoliyatini qanday atashlari haqida so'rovnoma o'tkazdim. Aksariyati sun'iy intellekt muhandisligi atamasini ma'qul ko'rdi. Men ham ko'pchilikning tanloviga qo'shilishga qaror qildim.

Jadal kengayib borayotgan _SI_ muhandislari hamjamiyati misli ko'rilmagan darajada qiziqarli va xilma-xil dasturlar bilan ajoyib ijodkorlikni namoyon etmoqda. Keyingi bo'limda eng keng tarqalgan dastur andozalaridan (_application patterns_) ba'zilari ko'rib chiqiladi.

### Izohlar

[^1]: Ingliz tilidan boshqa tillarda bitta _Unicode_ belgisi ba'zan bir nechta token sifatida ifodalanishi mumkin.

[^2]: Avtoregressiv til modellari ba'zan sababiy til modellari ([`causal language models`](https://huggingface.co/docs/transformers/en/tasks/language_modeling)) deb ham ataladi.

[^3]: Texnik jihatdan, agar juda qattiq harakat qilinsa, `BERT` kabi niqoblangan til modelidan ham matn generatsiyasi uchun foydalanish mumkin.

[^4]: Ma'lumotlarni belgilashning haqiqiy narxi bir nechta omillarga, jumladan, vazifaning murakkabligi, miqyosi (kattaroq ma'lumotlar to'plamlari odatda har bir namuna uchun arzonroq narxga olib keladi) va belgilash xizmatini taqdim etuvchi provayderga bog'liq. Masalan, 2024-yil sentabr holatiga ko'ra, [`Amazon SageMaker Ground Truth`](https://aws.amazon.com/sagemaker/ai/groundtruth/) 50 000 tadan kam rasmni belgilash uchun har bir rasmga 8 sent, 1 milliondan ortiq rasmni belgilash uchun esa har bir rasmga atigi 2 sent oladi.

[^5]: Bu xuddi insonlar uchun qachon gapirishni to'xtatishni bilish muhim bo'lganiga o'xshaydi.

[^6]: Maktabda menga model parametrlari ham model og'irliklari (_weights_), ham model siljishlari (_biases_)ni o'z ichiga oladi deb o'rgatishgan. Biroq, bugungi kunda biz odatda barcha parametrlarni nazarda tutib, model og'irliklari atamasini ishlatamiz.

[^7]: Kattaroq modellarga ko'proq o'qitish ma'lumotlari kerakligi mantiqqa zid tuyulishi mumkin. Agar model qudratliroq bo'lsa, o'rganish uchun kamroq namuna talab qilishi kerak emasmi? Biroq, bizning maqsadimiz katta modelning bir xil ma'lumotlar yordamida kichik modelning samaradorligiga erishishi emas. Bizning maqsadimiz — model samaradorligini maksimal darajaga chiqarishdir.

[^8]: Taqqoslash uchun, AQSHning davlat boshlang'ich va o'rta maktablari uchun umumiy xarajatlari taxminan 900 milliard dollarni tashkil etadi — bu AQSHdagi _SI_ investitsiyalaridan atigi to'qqiz baravar ko'p.
